<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Intro to R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Kevin Stachelek" />
    <meta name="date" content="2019-08-05" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Intro to R
## CodeOn! Bootcamp Session #2
### Kevin Stachelek
### 2019-08-05

---








# Learning Objectives

1. Understand the components of the [RStudio IDE](#rstudio_ide)
2. Type commands into the [console](#console)
3. Understand [function syntax](#function_syx)
4. Install a [package](#install-package)
5. [Organise a project](#projects)
6. Appropriately [structure an R script or RMarkdown file](#structure)
7. Create and compile an [Rmarkdown document](#rmarkdown)

---

# Resources

* [Chapter 1: Introduction](http://r4ds.had.co.nz/introduction.html) in *R for Data Science*

* [RStudio IDE Cheatsheet](https://github.com/rstudio/cheatsheets/raw/master/rstudio-ide.pdf)

* [Introduction to R Markdown](https://rmarkdown.rstudio.com/lesson-1.html)

* [R Markdown Cheatsheet](https://www.rstudio.com/wp-content/uploads/2016/03/rmarkdown-cheatsheet-2.0.pdf)

* [R Markdown Reference](https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf)

---

# What is R?

&lt;img src="images/01/new_R_logo.png" width="10%" /&gt;

R is a programming environment for data processing and statistical analysis. It is well suited to **reproducible research**. 

--

R allows you to write scripts that combine data files, clean data, and run analyses. There are many other ways to do this, but R has certain important advantages:

--

1. R is free
2. It has powerful plotting and graphics capabilities
3. Is well suited to interactive, trial and error data analysis 
5. Has an active and vibrant community especially in the life sciences  
6. Is welcoming to newcomers and underrepresented groups commonly marginalized in coding generally.

???

This refers to being able to document and reproduce all of the steps between raw data and results.

---

# Why Use R

&lt;img src="images/memes/why_use_R.png" width="50%" style="display: block; margin: auto;" /&gt;

---

# The Base R Console 

If you open up the application called R, you will see an "R Console" window that looks something like this.

&lt;div class="figure"&gt;
&lt;img src="images/01/r_console.png" alt="The R Console window." width="1968" /&gt;
&lt;p class="caption"&gt;The R Console window.&lt;/p&gt;
&lt;/div&gt;

You can close R and never open it again. We'll be working entirely in RStudio in this class.

&lt;div class="warning"&gt;
&lt;p&gt;ALWAYS REMEMBER: Launch R though the RStudio IDE&lt;/p&gt;
&lt;p&gt;Launch &lt;img src="images/01/rstudio_icon.png" style="height: 2em; vertical-align: middle;" alt="RStudio.app"&gt; (RStudio.app), not &lt;img src="images/01/new_R_logo.png" style="height: 2em; vertical-align: middle;" alt="R.app"&gt; (R.app).&lt;/p&gt;
&lt;/div&gt;

---

# RStudio 

[RStudio](http://www.rstudio.com) is an Integrated Development Environment (IDE). This is a program that serves as a text editor, file manager, and provides many functions to help you read and write R code.

&lt;div class="figure"&gt;
&lt;img src="images/01/rstudio.png" alt="The RStudio IDE" width="50%" /&gt;
&lt;p class="caption"&gt;The RStudio IDE&lt;/p&gt;
&lt;/div&gt;

---

# RStudio

RStudio is arranged with four window &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/p#panes'&gt;panes&lt;/a&gt;. 

By default, the upper left pane is the **source pane**, where you view and edit source code from files. 

The bottom left pane is usually the **console pane**, where you can type in commands and view output messages. 

The right panes have several different tabs that show you information about your code. 

You can change the location of panes and what tabs are shown under **`Preferences &gt; Pane Layout`**.

---

# Configure RStudio

You should learn how to develop **reproducible scripts**. 

This means scripts that completely and transparently perform some analysis from start to finish in a way that yields the same result for different people using the same software on different computers. 

--

&lt;img src="images/memes/forgetting.jpg" width="50%" style="display: block; margin: auto;" /&gt;

---

# Reproducibility

When you do things reproducibly, others can understand and check your work. 
+ The most important person who will benefit from a reproducible script is your __future self__. 

--

Two Rstudio tweaks to maximize reproducibility:
1. Go to the preferences/settings menu, and uncheck the box that says **`Restore .RData into workspace at startup`**
1. Set Save workspace on exit to **`Never`**

&lt;div class="figure"&gt;
&lt;img src="images/01/repro.png" alt="Alter these settings for increased reproducibility." width="50%" /&gt;
&lt;p class="caption"&gt;Alter these settings for increased reproducibility.&lt;/p&gt;
&lt;/div&gt;

???

If you keep things around in your workspace, things will get messy, and unexpected things will happen. You should always start with a clear workspace. This also means that you never want to save your workspace when you exit, so set this to **`Never`**. The only thing you want to save are your scripts.

---

# Getting Started

# Console commands 

We are first going to learn about how to interact with the console. You can consider the console a kind of **sandbox** where you can try out lines of code and adapt them. Then you can copy them back into the script editor.

--

You will often type into the script editor window (either into an R script or an R Markdown file) and then send the commands to the console by placing the cursor on the line and holding down the Ctrl key while you press Enter. 

--

The Ctrl+Enter key sequence sends the command in the script to the console.

--

&lt;img src="images/memes/typos.jpg" width="40%" style="display: block; margin: auto;" /&gt;

---

One simple way to learn about the R console is to use it as a calculator. Enter the lines of code below and see if your results match. Be prepared to make lots of typos (at first).


```r
1 + 1
```

```
## [1] 2
```

---

The R console remembers a history of the commands you typed in the past. Use the up and down arrow keys on your keyboard to scroll backwards and forwards through your history. It's a lot faster than re-typing.


```r
1 + 1 + 3
```

```
## [1] 5
```

You can break up math expressions over multiple lines; R waits for a complete expression before processing it.


```r
# here comes a long expression
# let's break it over multiple lines
1 + 2 + 3 + 4 + 5 + 6 +
    7 + 8 + 9 +
    10
```

```
## [1] 55
```

---

Text inside quotes is called a &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/s#string'&gt;string&lt;/a&gt;.


```r
"Good afternoon"
```

```
## [1] "Good afternoon"
```

---

You can break up text over multiple lines; R waits for a close quote before processing it. If you want to include a double quote inside this quoted string, &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/e#escape'&gt;escape&lt;/a&gt; it with a backslash.


```r
africa &lt;- "I hear the drums echoing tonight  
But she hears only whispers of some quiet conversation  
She's coming in, 12:30 flight  
The moonlit wings reflect the stars that guide me towards salvation  
I stopped an old man along the way  
Hoping to find some old forgotten words or ancient melodies  
He turned to me as if to say, \"Hurry boy, it's waiting there for you\"

- Toto"

cat(africa) # cat() prints the string
```

```
## I hear the drums echoing tonight  
## But she hears only whispers of some quiet conversation  
## She's coming in, 12:30 flight  
## The moonlit wings reflect the stars that guide me towards salvation  
## I stopped an old man along the way  
## Hoping to find some old forgotten words or ancient melodies  
## He turned to me as if to say, "Hurry boy, it's waiting there for you"
## 
## - Toto
```

---

# Variables 

Often you want to store the result of some computation for later use.  You can store it in a &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/v#variable'&gt;variable&lt;/a&gt;. A variable in R:

* contains only letters, numbers, periods, and underscores
* starts with a letter or a full stop and a letter
* distinguishes uppercase and lowercase letters (`rickastley` is not the same as `RickAstley`)

--

.pull-left[The following are valid and different variables:

* songdata
* SongData
* song_data
* song.data
* .song.data
* never_gonna_give_you_up_never_gonna_let_you_down
]
    
.pull-right[The following are not valid variables:

* _song_data
* 1song
* .1song
* song data
* song-data]


---

Use the assignment operator `&lt;-` to assign the value on the right to the variable named on the left.


```r
# use the assignment operator '&lt;-'
# R stores the number in the variable
x &lt;- 5
```

--

Now that we have set `x` to a value, we can do something with it:


```r
x * 2
```

```
## [1] 10
```

```r
# R evaluates the expression and stores the result in the variable
boring_calculation &lt;- 2 + 2
```

---

Note that it doesn't print the result back at you when it's stored. To view the result, just type the variable name on a blank line.


```r
boring_calculation
```

```
## [1] 4
```

--

Once a variable is assigned a value, its value doesn't change unless you reassign the variable, even if the variables you used to calculate it change. Predict what the code below does and test yourself:


```r
this_year &lt;- 2019
my_birth_year &lt;- 1976
my_age &lt;- this_year - my_birth_year
this_year &lt;- 2020
```

???

After all the code above is run:

* `this_year` = &lt;select class='solveme' data-answer='["2020"]'&gt; &lt;option&gt;&lt;/option&gt; &lt;option&gt;43&lt;/option&gt; &lt;option&gt;44&lt;/option&gt; &lt;option&gt;1976&lt;/option&gt; &lt;option&gt;2019&lt;/option&gt; &lt;option&gt;2020&lt;/option&gt;&lt;/select&gt;
* `my_birth_year` = &lt;select class='solveme' data-answer='["1976"]'&gt; &lt;option&gt;&lt;/option&gt; &lt;option&gt;43&lt;/option&gt; &lt;option&gt;44&lt;/option&gt; &lt;option&gt;1976&lt;/option&gt; &lt;option&gt;2019&lt;/option&gt; &lt;option&gt;2020&lt;/option&gt;&lt;/select&gt;
* `my_age` = &lt;select class='solveme' data-answer='["43"]'&gt; &lt;option&gt;&lt;/option&gt; &lt;option&gt;43&lt;/option&gt; &lt;option&gt;44&lt;/option&gt; &lt;option&gt;1976&lt;/option&gt; &lt;option&gt;2019&lt;/option&gt; &lt;option&gt;2020&lt;/option&gt;&lt;/select&gt;

---

# The environment

Anytime you assign something to a new variable, R creates a new object in the &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/g#global-environment'&gt;global environment&lt;/a&gt;. Objects in the global environment exist until you end your session; then they disappear forever (unless you save them).

--

The **Environment** tab in the upper right pane lists all of the variables you have created. 

Click the broom icon to clear all of the variables and start fresh. 

You can also use the following functions in the console to view all variables, remove one variable, or remove all variables. 


```r
ls()            # print the variables in the global environment
rm("x")         # remove the variable named x from the global environment
rm(list = ls()) # clear out the global environment
```

---

# Whitespace

When you see `&gt;` at the beginning of a line, that means R is waiting for you to start a new command.  

--

However, if you see a `+` instead of `&gt;` at the start of the line, that means R is waiting for you to finish a command you started on a previous line.  

--

If you want to cancel whatever command you started, just press the Esc key in the console window and you'll get back to the `&gt;` command prompt.

--


```r
# R waits until next line for evaluation
(3 + 2) *
     5
```

```
## [1] 25
```

---

It is often useful to break up long functions onto several lines.


```r
cat("row, row, row your boat",
    "gently down the stream",
    "merrily, merrily, merrily, merrily",
    "life is but a dream.",
    sep = "  \n")
```

```
## row, row, row your boat  
## gently down the stream  
## merrily, merrily, merrily, merrily  
## life is but a dream.
```

---

# Function syntax 

A lot of what you do in R involves calling a &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/f#function'&gt;function&lt;/a&gt; and storing the results. A function is a named section of code that can be reused. 

--

For example, `sd` is a function that returns the standard deviation of the &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/v#vector'&gt;vector&lt;/a&gt; of numbers that you provide as the input &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/a#argument'&gt;argument&lt;/a&gt;. Functions are set up like this: 

`function_name(argument1, argument2 = "value")`. 

---

The arguments in parentheses can be named like, `argument1 = 10` or you can skip the names if you put them in the exact same order that they're defined in the function. 

--

You can check this by typing `?sd` (or whatever function name you're looking up) into the console and the Help pane will show you the default order under **Usage**. You can also skip arguments that have a default value specified.

---

# Functions

Most functions return a value, but may also produce side effects like printing to the console.

--

To illustrate, the function `rnorm()` generates random numbers from the standard normal distribution.  

The help page for `rnorm()` (accessed by typing `?rnorm` in the console) shows that it has the syntax 

`rnorm(n, mean = 0, sd = 1)`

???

where `n` is the number of randomly generated numbers you want, `mean` is the mean of the distribution, and `sd` is the standard deviation. The default mean is 0, and the default standard deviation is 1. There is no default for `n`, which means you'll get an error if you don't specify it:

---

# Functions


```r
rnorm()
```

```
## Error in rnorm(): argument "n" is missing, with no default
```

If you want 10 random numbers from a distribution with mean of 0 and standard deviation, you can just use the defaults.


```r
rnorm(10)
```

```
##  [1]  2.4446182 -1.4718041  0.7378830 -0.3369591 -0.5006928  1.1250378
##  [7]  0.6637525  0.7238453 -0.9519130  0.0952774
```

---

# Functions

If you want 10 numbers from a distribution with a mean of 100:


```r
rnorm(10, 100)
```

```
##  [1] 100.26886 101.12432 100.26942 101.75645 100.96122  99.53662 100.83251
##  [8]  99.71168 100.23828  99.75163
```

This would be an equivalent but less efficient way of calling the function:


```r
rnorm(n = 10, mean = 100)
```

```
##  [1]  99.84114 100.10671 100.98003 100.75760 100.95909 100.27624 100.84476
##  [8]  99.70607  98.82152 100.20354
```

---

We don't need to name the arguments because R will recognize that we intended to fill in the first and second arguments by their position in the function call. 

However, if we want to change the default for an argument coming later in the list, then we need to name it. 

For instance, if we wanted to keep the default `mean = 0` but change the standard deviation to 100 we would do it this way:


```r
rnorm(10, sd = 100)
```

```
##  [1]   -6.051261  -63.076798 -118.627080  119.986490  -78.120925
##  [6]   66.760625  -89.422723   68.854396    2.198367   89.657731
```

---

# Functions

Some functions give a list of options after an argument; this means the default value is the first option. The usage entry for the `power.t.test()` function looks like this:


```r
power.t.test(n = NULL, delta = NULL, sd = 1, sig.level = 0.05,
             power = NULL,
             type = c("two.sample", "one.sample", "paired"),
             alternative = c("two.sided", "one.sided"),
             strict = FALSE, tol = .Machine$double.eps^0.25)
```

???

* What is the default value for `sd`? &lt;select class='solveme' data-answer='["1"]'&gt; &lt;option&gt;&lt;/option&gt; &lt;option&gt;NULL&lt;/option&gt; &lt;option&gt;1&lt;/option&gt; &lt;option&gt;0.05&lt;/option&gt; &lt;option&gt;two.sample&lt;/option&gt;&lt;/select&gt;
* What is the default value for `type`? &lt;select class='solveme' data-answer='["two.sample"]'&gt; &lt;option&gt;&lt;/option&gt; &lt;option&gt;NULL&lt;/option&gt; &lt;option&gt;two.sample&lt;/option&gt; &lt;option&gt;one.sample&lt;/option&gt; &lt;option&gt;paired&lt;/option&gt;&lt;/select&gt;
* Which is equivalent to `power.t.test(100, 0.5)`? &lt;select class='solveme' data-answer='["power.t.test(delta = 0.5, n = 100)"]'&gt; &lt;option&gt;&lt;/option&gt; &lt;option&gt;power.t.test(100, 0.5, sig.level = 1, sd = 0.05)&lt;/option&gt; &lt;option&gt;power.t.test()&lt;/option&gt; &lt;option&gt;power.t.test(n = 100)&lt;/option&gt; &lt;option&gt;power.t.test(delta = 0.5, n = 100)&lt;/option&gt;&lt;/select&gt;


---


# Getting help 

Start up help in a browser using the function `help.start()`.

--

If a function is in base R or a loaded package, you can use the `help("function_name")` function or the `?function_name` shortcut to access the help file. 

--

If the package isn't loaded, specify the package name as the second argument to the help function.


```r
# these methods are all equivalent ways of getting help
help("rnorm")
?rnorm
help("rnorm", package="stats") 
```

--

When the package isn't loaded or you aren't sure what package the function is in, use the shortcut `??function_name`.

???

* What is the first argument to the `mean` function? &lt;select class='solveme' data-answer='["x"]'&gt; &lt;option&gt;&lt;/option&gt; &lt;option&gt;trim&lt;/option&gt; &lt;option&gt;na.rm&lt;/option&gt; &lt;option&gt;mean&lt;/option&gt; &lt;option&gt;x&lt;/option&gt;&lt;/select&gt;
* What package is `read_excel` in? &lt;select class='solveme' data-answer='["readxl"]'&gt; &lt;option&gt;&lt;/option&gt; &lt;option&gt;readr&lt;/option&gt; &lt;option&gt;readxl&lt;/option&gt; &lt;option&gt;base&lt;/option&gt; &lt;option&gt;stats&lt;/option&gt;&lt;/select&gt;

---

# Add-on packages 

One of the great things about R is that it is **user extensible**: anyone can create a new add-on software package that extends its functionality. 

There are currently thousands of add-on packages that R users have created to solve many different kinds of problems or to have fun. 

???

There are packages for data visualisation, machine learning, neuroimaging, eyetracking, web scraping, and playing games such as Sudoku.

---

# Packages

Add-on packages are not distributed with base R, but have to be downloaded and installed from an archive, in the same way that you would, for instance, download and install an app on your smartphone.

--

The main repository where packages reside is called CRAN, the Comprehensive R Archive Network. A package has to pass strict tests devised by the R core team to be allowed to be part of the CRAN archive. 

--

You can install from the CRAN archive through R using the `install.packages()` function.

--

There is an important distinction between **installing** a package and **loading** a package.

---

# Installing a package 

&lt;img src="images/memes/pokemon.gif" width="50%" /&gt;

This is done using `install.packages()`. 

--

This is like installing an app on your phone: you only have to do it once and the app will remain installed until you remove it. 

--

When you install a package, the package will be available (but not *loaded*) every time you open up R.

???

For instance, if you want to use PokemonGo on your phone, you install it once from the App Store or Play Store, and you don't have to re-install it each time you want to use it. Once you launch the app, it will run in the background until you close it or restart your phone. 

&lt;div class="warning"&gt;
&lt;p&gt;You may only be able to permanently install packages if you are using R on your own system; you may not be able to do this on public workstations if you lack the appropriate privileges.&lt;/p&gt;
&lt;/div&gt;

---

Install the `fortunes` package on your system:


```r
install.packages("fortunes")
```

If you don't get an error message, the installation was successful. 

---

# Loading a package

This is done using `library(packagename)`. 

--

This is like **launching** an app on your phone: the functionality is only there where the app is launched and remains there until you close the app or restart. 

When you run `library(packagename)` within a session, the package referred to by `packagename` will be available for your R session.

--

The next time you start R, you will need to run the `library()` function again if you want to use it.

---

You can load the functions in `fortune` for your current R session as follows:


```r
library(fortunes)
```

--

Once you have typed this, you can run the function `fortune()`, which spouts random wisdom from one of the R help lists:


```r
fortune()
```

```
## 
## Dirk Eddelbuettel: Could it get any more un-scientific and un-empirical?
## Maybe we should debate whether it is faster on Thursdays than on
## Wednesdays too?
## Thomas Lumley: That's easy. It's faster on Wednesdays, because faculty
## meeting and seminar are on Thursday (so more faculty are on campus using
## the computers) and homework for the applied regression sequence is due on
## Friday (so more students are using the computers).
##    -- Dirk Eddelbuettel and Thomas Lumley (after a rather vague disucssion
##       which language is fastest for numerical computations)
##       R-help and private communication (September 2010)
```

--

The convention `package::function()` is used to indicate in which add-on package a function resides. 

--

For instance, if you see `readr::read_csv()`, that refers to the function `read_csv()` in the `readr` add-on package.

---

# Install from GitHub

Many R packages are not yet on CRAN or Bioconductor because they are still in development. 

--

Increasingly, datasets and code for papers are available as packages you can download from github.

--

You'll need to install the devtools package to be able to install packages from github. 

--

Check if you have a package installed by trying to load it (e.g., if you don't have devtools installed, `library("devtools")` will display an error message) 

--

or by searching for it in the packages tab in the lower right pane. All listed packages are installed; all checked packages are currently loaded.

&lt;div class="figure"&gt;
&lt;img src="images/01/packages.png" alt="Check installed and loaded packages in the packages tab in the lower right pane." width="100%" /&gt;
&lt;p class="caption"&gt;Check installed and loaded packages in the packages tab in the lower right pane.&lt;/p&gt;
&lt;/div&gt;

---

#  Install a package from Github


```r
install.packages("devtools")
devtools::install_github("adam-gruer/goodshirt")
```

After you install the goodshirt package, load it using the `library()` function and display some quotes using the functions below. 


```r
library(goodshirt)
# quotes from The Good Place
chidi()
```

```
## 
##  You know, I thought I'd have a stomachache right now, but weirdly... I do. 
## 
##  ~ Chidi
```

```r
eleanor()
```

```
## 
##  Oh, so now I'm supposed to be nice and make friends and treat her with mutual respect? 
## 
##  ~ Eleanor
```

???

&lt;div class="try"&gt;
&lt;p&gt;How many different ways can you find to discover what functions are available in the goodshirt package?&lt;/p&gt;
&lt;/div&gt;

---

# Organising a project 

Projects in RStudio are a way to group all of the files you need for one project. Most projects include scripts, data files, and output files like the PDF version of the script or images.

&lt;div class="try"&gt;
&lt;p&gt;Make a new directory where you will keep all of your materials for this class. If you’re using a lab computer, make sure you make this directory in your network drive so you can access it from other computers.&lt;/p&gt;
&lt;p&gt;Choose &lt;strong&gt;&lt;code&gt;New Project...&lt;/code&gt;&lt;/strong&gt; under the &lt;strong&gt;&lt;code&gt;File&lt;/code&gt;&lt;/strong&gt; menu to create a new project called &lt;code&gt;01-intro&lt;/code&gt; in this directory.&lt;/p&gt;
&lt;/div&gt;

---

# An Example Script

Here is what an R script looks like. Don't worry about the details for now.


```r
# load add-on packages
library(tidyverse)

# set variables ----
n &lt;- 100

# simulate data ----
data &lt;- data.frame(
  id = 1:n,
  dv = c(rnorm(n/2, 0), rnorm(n/2, 1)),
  condition = rep(c("A", "B"), each = n/2)
)

# plot data ----
ggplot(data, aes(condition, dv)) +
  geom_violin(trim = FALSE) +
  geom_boxplot(width = 0.25, 
               aes(fill = condition),
               show.legend = FALSE)

# save plot ----
ggsave("sim_data.png", width = 8, height = 6)
```

---

# Script Structure

It's best if you follow the following structure when developing your own scripts: 

1. load in any add-on packages you need to use
1. define any custom functions
1. load or simulate the data you will be working with
1. work with the data
1. save anything you need to save

???

Often when you are working on a script, you will realize that you need to load another add-on package. Don't bury the call to `library(package_I_need)` way down in the script. Put it in the top, so the user has an overview of what packages are needed.

---

# Add Comments to your Script (The Why)

You can add comments to an R script with the hash symbol (`#`). 

The R interpreter will ignore characters from the hash to the end of the line.


```r
# comments: any text from '#' on is ignored until end of line
22 / 7  # approximation to pi
```

```
## [1] 3.142857
```

---

# Reproducible reports with R Markdown

We will make reproducible reports following the principles of [literate programming](https://en.wikipedia.org/wiki/Literate_programming).

--

The basic idea is to have the text of the report together in a single document along with the code needed to perform all analyses and generate the tables.

--

The report is then "compiled" from the original format into some other, more portable format, such as HTML or PDF. 

???

This is different from traditional cutting and pasting approaches where, for instance, you create a graph in Microsoft Excel or a statistics program like SPSS and then paste it into Microsoft Word.

---

# Reproducible reports with R Markdown


We will use [R Markdown](http://rmarkdown.rstudio.com/lesson-1.html) to create reproducible reports, which enables mixing of text and code.

--

A reproducible script will contain sections of code in code blocks. 

--

A code block starts and ends with backtick symbols in a row, with some infomation about the code between curly brackets, such as `{r chunk-name, echo=FALSE}` (this runs the code, but does not show the text of the code block in the compiled document). 

--

The text outside of code blocks is written in &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/m#markdown'&gt;markdown&lt;/a&gt;, which is a way to specify formatting, such as headers, paragraphs, lists, bolding, and links.

&lt;div class="figure"&gt;
&lt;img src="images/01/reproducibleScript.png" alt="A reproducible script." width="2235" /&gt;
&lt;p class="caption"&gt;A reproducible script.&lt;/p&gt;
&lt;/div&gt;

---

# Reproducible reports with R Markdown

If you open up a new RMarkdown file from a template, you will see an example document with several code blocks in it. 

--

To create an HTML or PDF report from an R Markdown (Rmd) document, you compile it.  

--

Compiling a document is called &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/k#knitting'&gt;knit&lt;/a&gt; in RStudio. 

--

There is a button that looks like a ball of yarn with needles through it that you click on to compile your file into a report. 

---

# Working Directory

Where should I put all my files? 

--

When developing an analysis, you usually want to have all of your scripts and data files in one subtree of your computer's directory structure. 

--

Usually there is a single **working directory** where your data and scripts are stored.

--

Your script should only reference files in three locations, using the appropriate format.

| Where                    | Example |
|--------------------------|---------|
| on the web               | "https://psyteachr.github.io/msc-data-skills/data/disgust_scores.csv" |
| in the working directory | "disgust_scores.csv"  |
| in a subdirectory        | "data/disgust_scores.csv" |

---

# Working Directory

If you are working with an R Markdown file, it will automatically use the same directory the .Rmd file is in as the working directory. 

--

If you are working with R scripts, store your main script file in the top-level directory and manually set your working directory to that location. 

--

If your script needs a file in a subdirectory of `new_analysis`, say, `data/questionnaire.csv`, load it in using a &lt;a class='glossary' target='_blank' title='' href='https://psyteachr.github.io/glossary/r#relative-path'&gt;relative path&lt;/a&gt;:


```r
dat &lt;- read_csv("data/questionnaire.csv")  # right way
```

???

Do not load it in using an absolute path:


```r
dat &lt;- read_csv("C:/Carla's_files/thesis22/my_thesis/new_analysis/data/questionnaire.csv")   # wrong
```

&lt;div class="info"&gt;
&lt;p&gt;Also note the convention of using forward slashes, unlike the Windows-specific convention of using backward slashes. This is to make references to files platform independent.&lt;/p&gt;
&lt;/div&gt;

---

# Closing Thoughts

.pull-left[
&lt;img src="images/memes/googling.jpg" width="70%" style="display: block; margin: auto;" /&gt;
]
.pull-right[
&lt;img src="images/memes/changing-stuff.jpg" width="70%" style="display: block; margin: auto;" /&gt;
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
